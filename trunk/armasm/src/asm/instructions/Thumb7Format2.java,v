head	1.3;
access;
symbols;
locks; strict;
comment	@# @;


1.3
date	2003.02.20.15.38.40;	author hans;	state Exp;
branches;
next	1.2;

1.2
date	2003.02.07.18.18.41;	author hans;	state Exp;
branches;
next	1.1;

1.1
date	2003.02.03.16.47.12;	author hans;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Thumb support updates
@
text
@package asm.instructions;

/* Format 2: add/subtract
 */
public class Thumb7Format2 extends Thumb7Instruction {
    public Thumb7Format2(ParsedInstruction pi) {
        super(pi);
        java.util.Vector opcodes = pi.getOpcodes();
        set(11);
        set(12);
        
        // Rd
        set(2, 0, getRegisterNumber((String)opcodes.elementAt(1)));
        
        //Rs
        set(5, 3, getRegisterNumber((String)opcodes.elementAt(2)));
        
        /* Rn/Offset3 */
        int offset;
        String ofs = null;
        try {
            ofs = (String)opcodes.elementAt(3);
            if (ofs.startsWith("#")) {
                offset = parseExpression(ofs.substring(1));
                set(10);
            } else {
                offset = getRegisterNumber(ofs);
            }
        } catch (ArrayIndexOutOfBoundsException  ae) {
            offset = 0;
        } catch (Exception e) {
            error(ofs + "Syntax error, expected #Offset3 or Rn ");
            return;
        }
        int i=1;
        for ( int bit = 6; bit <= 8; bit++ ) {
            if ( ( offset & i ) == i ) {
                set(bit);
            }
            i = i * 2;
        }
    }
}
@


1.2
log
@Thumb7 support update
@
text
@d3 2
d13 1
a13 8
        int rd = getRegisterNumber((String)opcodes.elementAt(1));
        int i = 1;
        for ( int bit = 0; bit <= 3; bit++ ) {
            if ( ( rd & i ) == i ) {
                set(bit);
            }
            i = i * 2;
        }
d16 2
a17 8
        int rs = getRegisterNumber((String)opcodes.elementAt(2));
        i = 1;
        for ( int bit = 3; bit <= 5; bit++ ) {
            if ( ( rs & i ) == i ) {
                set(bit);
            }
            i = i * 2;
        }
d35 1
a35 1
        i=1;
@


1.1
log
@*** empty log message ***
@
text
@d7 46
@

